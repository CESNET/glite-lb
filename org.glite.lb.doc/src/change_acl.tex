%
%% Copyright (c) Members of the EGEE Collaboration. 2004-2010.
%% See http://www.eu-egee.org/partners for details on the copyright holders.
%% 
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%% 
%%     http://www.apache.org/licenses/LICENSE-2.0
%% 
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.
%
%
%% Copyright (c) Members of the EGEE Collaboration. 2004-2010.
%% See http://www.eu-egee.org/partners for details on the copyright holders.
%% 
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%% 
%%     http://www.apache.org/licenses/LICENSE-2.0
%% 
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.
%
\subsubsection{Example: Changing Job Access Control List}
\label{e:change-acl}

In order to change the Access Control List (ACL) for a job, a special event
\verb'ChangeACL' is used. This event can be logged by the job owner using the
\verb'glite-lb-logevent' command (see also Sect.~\ref{glite-lb-logevent}).
General template for changing the ACL is as follows:

\begin{verbatim}
glite-lb-logevent -e ChangeACL -s UserInterface -p --permission 1          
        -j <job_id>                                                     
        --user_id <user_id>                                             
        --user_id_type <user_id_type>                                   
        --permission_type <permission_type> --operation <operation>
\end{verbatim}

where

\begin{tabularx}{\textwidth}{>{\texttt}lX}
<job\_id>    & specifies the job to change \\
<user\_id>   & specifies the user to use, can be either an X.500 name
               (subject name), a VOMS group (of the form VO:Group), or a Full
               qualified attribute name (FQAN). FQANs are only supported in \LBnew. \\
<user\_id\_type>   & \texttt{0}, \texttt{1}, or \texttt{2} indicating \texttt{user\_id}
                     specifies X.500 name, VOMS group, or FQAN, respectively \\
<permission\_type> & \texttt{0} or \texttt{1} indicating the user is 
                     \textit{allowed} or \textit{denied}, respectively \\
<operation>  & \texttt{0} or \texttt{1} indicating the record carried in
               the event shall be added or removed, respectively from
               the ACL \\
\end{tabularx}


Adding a user specified by his or her subject name to the ACL \\
(\verb'user_id' = subject name, \verb'user_id_type' = 0, 
\verb'permission_type' = 0, \verb'operation' = 0):

\begin{verbatim}
glite-lb-logevent -e ChangeACL -s UserInterface -p --permission 1       \
        -j https://scientific.civ.zcu.cz:9000/PC8Y6jBitHt_fKMTEKFnVw    \
        --user_id '/O=CESNET/O=Masaryk University/CN=Daniel Kouril'     \
        --user_id_type 0 --permission_type 0 --operation 0
\end{verbatim}


Removing a user specified by his or her subject name from the ACL \\
(\verb'user_id' = subject name, \verb'user_id_type' = 0, 
\verb'permission_type' = 0, \verb'operation' = 1):

\begin{verbatim}
glite-lb-logevent -e ChangeACL -s UserInterface -p --permission 1       \
        -j https://scientific.civ.zcu.cz:9000/PC8Y6jBitHt_fKMTEKFnVw    \
        --user_id '/O=CESNET/O=Masaryk University/CN=Daniel Kouril'     \
        --user_id_type 0 --permission_type 0 --operation 1
\end{verbatim}


Adding a VOMS group to the ACL \\
(\verb'user_id' = VOMS group, \verb'user_id_type' = 1, 
\verb'permission_type' = 0, \verb'operation' = 0):

\begin{verbatim}
glite-lb-logevent -e ChangeACL -s UserInterface -p --permission 1       \
        -j https://scientific.civ.zcu.cz:9000/PC8Y6jBitHt_fKMTEKFnVw    \
        --user_id 'VOCE:/VOCE'                                          \
        --user_id_type 1 --permission_type 0 --operation 0
\end{verbatim}


Denying a particular user from accessing information about the job, can be
combined e.g. with VOMS groups (\verb'user_id' = subject name,
\verb'user_id_type' = 0, \verb'permission_type' = 1, \verb'operation' = 0):

\begin{verbatim}
glite-lb-logevent -e ChangeACL -s UserInterface -p --permission 1       \
        -j https://scientific.civ.zcu.cz:9000/PC8Y6jBitHt_fKMTEKFnVw    \
        --user_id '/O=CESNET/O=Masaryk University/CN=Daniel Kouril'     \
        --user_id_type 0 --permission_type 1 --operation 0
\end{verbatim}

