\section{Introduction}

This document explains how to test the Logging and Bookkeeping (\LB) service. 

As part of the EGEE-III project, Specific Service Activity SA3: Integration,
testing and certification\footnote{\url{https://twiki.cern.ch/twiki/bin/view/EGEE/SA3}}, 
testing is an essential activity and all important information about gLite software 
testing should be available from the webpage

\begin{center}
\url{https://twiki.cern.ch/twiki/bin/view/EGEE/EGEECertification#Test_writing}.
\end{center}

This document describes test plan for the \LB service.


\subsection{Test Categories}

% Obsolete, not used anymore:
%
% Several layers of tests are considered:
% \begin{description}
% \item[Layer 1 - service ping tests:] Basic test if a service is up and running.
% \item[Layer 2 - service functionality tests:] Test the fully supported functionality of a service. This includes also service interface tests.
% \item[Layer 3 - system tests:] Test a complete system that traverses multiple services.
% \item[Layer 4 - stress tests:] Stress test services and systems (including long running jobs to check for resource leaks).
% \item[Layer 5 - performance tests:] Test performance of the service (including the MegaJob results).
% \item[Layer 6 - interoperability tests:] Test for interoperability with other grids (might be interactive).
% \end{description}

According to the gLite Test Writnig Guidelines
\footnote{\url{https://twiki.cern.ch/twiki/bin/view/LCG/LCGgliteTestWritingGuidelines}},
we consider two test categories with the following test types:

\begin{description} 
\item[Integration tests] verify if the software is installable and configurable
They also check for basic, not depending on other grid services, functionality
of the component (e.g. daemon is up and running).
\begin{enumerate}
\item installation tests,
\item configuration tests,
\item service ping tests: basic tests if service is up and running.
\end{enumerate}
%
\item[System tests] verify if the component works within the grid in
interaction with other grid services.
\begin{enumerate}
\item functionality tests of fully supported functionality (including APIs and CLI), 	
\item stress tests and performance tests,
\item interoperability tests,
\item security tests.
\end{enumerate}
\end{description}

The tests could be run either locally (on the install node = where the service
is installed, configured and running) or remotely (via another node, where some
parts of the software also must be installed).

Apart from these tests, there exist also tests of the individual components run
for example during the build process (especially unit tests). They are not
described in this document.


\subsection{Tests in \texttt{org.glite.testsuites.ctb/LB}}
\TODO{implementation} 

EGEE Certification team collects tests for \LB in a gLite module
\verb'org.glite.testsuites.ctb' in the \verb'LB' directory. All \LB tests are
described at
\url{https://twiki.cern.ch/twiki/bin/view/LCG/SAMTests#Logging_and_Bookkeeping_LB}
as well as next to each test case in Sections \ref{s:tests} and \ref{s:perftests}.

The tests can be used as sensors in different monitoring frameworks 
(see also below).




\subsection{Integration into other frameworks}

\subsubsection{Service Availability Monitoring}

Service Availability Monitoring
(SAM)\footnote{\url{http://sam-docs.web.cern.ch/sam-docs}} is a framework for
the monitoring of production and pre-production grid sites. It provides a set
of probes which are submitted at regular intervals, and a database that stores
test results. In effect, SAM provides monitoring of grid services from a user
perspective. 

\TODO{More about SAM. How LB is integrated - LB sensors for SAM}


\subsubsection{Nagios} 

Nagios\footnote{\url{http://www.nagios.org}} is a host and service monitor
designed to inform you of network problems before your clients, end-users or
managers do.

\TODO{More about Nagios. How LB is integrated - LB sensors for Nagios?}


\subsubsection{ETICS}

ETICS\footnote{\url{http://etics.web.cern.ch/etics/}} stands for
"eInfrastructure for Testing, Integration and Configuration of Software". It
provides a service to help software developers, managers and users to better
manage complexity and improve the quality of their software. Using cutting
edge Grid software and best practices, ETICS allows to fully automate
the way your software is built and tested.

Please see the ETICS User Manual \cite{etics_manual} for the description
of the ETICS service and basic ETICS commands. The command to be issued to 
test the whole \LB subsystem is:

\begin{verbatim}
   etics-test org.glite.lb
\end{verbatim}

It can be issued locally or using the remote build and test system.
\TODO{More about ETICS testing}

General ideas of \LB tests using ETICS are the following

\begin{itemize}
\item tests are in CVS together with the code

\item tests run the service themselves on some nondefault ports and perform a set of 
elementary actions similar to those from org.glite.testsuites.ctb/LB
to test the basic functionality of the service which is stopped again at the 
end of the test

\end{itemize} 
\TODO{More about LB tests for individual modules?}
